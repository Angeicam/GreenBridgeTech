<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GreenBridge √ânergie - Panneaux Solaires</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --topbar-h:48px;
  --header-h:72px;
  --green-dark:#061f14;
  --green-mid:#073217;
  --green-mid-2:#0b4d26;
  --accent:#7cb342;
  --accent-2:#a8e6a1;
  --bg:#0a4d2e;
  --gold-base:#d4af37;
  --electric-yellow:#ffd600;
}

/* Base */
*{box-sizing:border-box}
html,body{margin:0;padding:0;font-family:'Poppins',Arial,sans-serif;background:var(--bg);color:#fff;scroll-behavior:smooth;overflow-x:hidden}
a{color:inherit;text-decoration:none}

/* Topbar */
.topbar{position:fixed;top:0;left:0;right:0;height:var(--topbar-h);background:var(--green-dark);display:flex;align-items:center;justify-content:space-between;gap:20px;padding:0 5vw;z-index:1800;font-size:14px}
.topbar a{color:#fff;transition:color .18s}
.topbar a:hover{color:var(--accent-2)}

/* Header */
header{position:fixed;top:var(--topbar-h);left:0;right:0;height:var(--header-h);background:linear-gradient(90deg,var(--green-mid),var(--green-mid-2));display:flex;align-items:center;justify-content:space-between;padding:0 5vw;z-index:1750;box-shadow:0 4px 12px rgba(0,0,0,.25)}
.logo-text{display:flex;align-items:center;gap:12px}
.logo-text img{height:56px;display:block}
.company-name{font-size:28px;font-weight:800;letter-spacing:1px;padding:6px 10px;border-radius:8px;color:#04462e;-webkit-text-stroke:0.95px var(--gold-base);text-shadow:0 3px 6px rgba(0,0,0,0.6)}

/* Nav desktop */
nav{display:flex;gap:18px;align-items:center}
nav a{color:#fff;font-size:15px;font-weight:600;padding:8px 10px;border-radius:8px;transition:all .18s;display:flex;gap:8px;align-items:center}
nav a:hover{color:var(--accent-2)}
nav a.active{color:var(--accent-2);background: linear-gradient(90deg, rgba(212,175,55,0.06), rgba(212,175,55,0.03));border:1px solid rgba(212,175,55,0.22);padding:10px 14px;font-weight:800;border-radius:10px}

/* Desktop badge next to √ânergie */
.dropdown > a .sub-badge{
  margin-left:8px;padding:6px 10px;border-radius:10px;
  /* default style (will be overridden by JS for 'transparent' active) */
  background: rgba(255,214,0,0.08); color: var(--electric-yellow); font-weight:800; font-size:13px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.32); white-space:nowrap;display:inline-flex;align-items:center;cursor:default;user-select:none;
  transition:background .18s, box-shadow .18s, color .18s;
}

/* Caret styling - keep color consistent */
.caret-desktop{margin-left:8px;padding:6px;border-radius:8px;background: rgba(255,255,255,0.02);cursor:pointer;display:inline-flex;align-items:center;justify-content:center}
.caret-desktop i{color:var(--accent-2); font-size:14px}
.caret-desktop:hover{ background: rgba(255,255,255,0.04); }

/* hide badge on small screens */
@media (max-width:1100px){ .dropdown > a .sub-badge{display:none} }

/* Dropdown visuals */
.dropdown{position:relative}
.dropdown > a{display:flex;gap:6px;align-items:center}
.dropdown > a::after{ content:"\25BC"; font-size:12px; margin-left:6px; transition:transform .2s; opacity:0; pointer-events:none; }
.dropdown[aria-expanded="true"] > a::after{ transform:rotate(180deg); }

/* Content */
.dropdown-content{display:none;position:absolute;top:calc(100% + 8px);left:0;background:rgba(0,0,0,0.85);padding:8px 0;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.5);min-width:220px;z-index:2000}
.dropdown-content li{list-style:none}
.dropdown-content a{display:block;padding:10px 16px;color:#fff;font-weight:600;border-radius:8px}
.dropdown-content a:hover{background:rgba(168,230,161,0.12);color:var(--accent-2);padding-left:24px}

/* active child in dropdown (desktop) */
.dropdown-content .active-item{
  color: var(--accent-2);
  background: linear-gradient(90deg, rgba(212,175,55,0.06), rgba(212,175,55,0.03));
  border: 1px solid rgba(212,175,55,0.12);
  padding: 10px 16px; font-weight: 800; border-radius: 8px; box-shadow: 0 8px 20px rgba(0,0,0,0.28); margin: 4px 8px;
}
/* mobile override: active-item becomes subtle / transparent */
@media (max-width:1100px){
  .dropdown-content .active-item{ margin:0; border:none; box-shadow:none; background:transparent; color:inherit; padding:10px 16px; }
}

/* Burger (mobile) */
.burger{display:none !important;width:44px;height:44px;border-radius:8px;border:none;background:transparent;align-items:center;justify-content:center;cursor:pointer}
.burger .icon{display:block;position:relative;width:26px;height:18px}
.burger .icon span{position:absolute;left:0;right:0;height:3px;background:#fff;border-radius:2px;transition:all .25s}
.burger .icon span:nth-child(1){top:0}
.burger .icon span:nth-child(2){top:7.5px}
.burger .icon span:nth-child(3){top:15px}
.burger.open .icon span:nth-child(1){transform: translateY(7.5px) rotate(45deg)}
.burger.open .icon span:nth-child(2){opacity:0}
.burger.open .icon span:nth-child(3){transform: translateY(-7.5px) rotate(-45deg)}

/* Mobile nav */
.mobile-nav{display:none;position:fixed;top:calc(var(--topbar-h) + var(--header-h));left:0;right:0;background:var(--bg);z-index:1740;box-shadow:0 12px 40px rgba(0,0,0,.45);overflow:auto;max-height:0;transition:max-height .28s ease}
.mobile-nav.open{ display:block; max-height:85vh; }
.mobile-nav .inner{ padding:12px 5vw; display:flex; flex-direction:column; gap:8px; align-items:stretch; }
.mobile-nav a{ padding:12px; color:#fff; width:100%; text-align:left; border-radius:8px; font-weight:700; display:flex; justify-content:space-between; align-items:center }
.mobile-nav a:hover{ background:rgba(124,179,66,0.06); color:var(--accent-2) }
.mobile-nav a.active{ background: linear-gradient(90deg, rgba(212,175,55,0.06), rgba(212,175,55,0.03)); color:var(--accent-2) }

/* submenus */
.mobile-nav .submenu{ display:none; flex-direction:column; padding-left:12px; margin-top:6px; margin-bottom:6px; gap:6px }
.mobile-nav .submenu a{ font-weight:600; padding:8px 12px; border-radius:6px; text-align:left }
.mobile-nav .submenu a:hover{ background:rgba(168,230,161,0.08); padding-left:18px }

/* mobile: show current subpage on the Energie toggle */
.mobile-nav .mobile-link.active[data-current]::after {
  content: attr(data-current);
  margin-left:8px;
  padding:6px 10px;
  border-radius:8px;
  background: rgba(255,214,0,0.06);
  color: var(--electric-yellow);
  font-weight:800;
  font-size:13px;
  white-space:nowrap;
}

/* mobile active-item subtle style (transparent look) */
.mobile-nav .submenu span.active-item,
.mobile-nav .submenu a.active-item,
.mobile-nav .submenu [aria-current="page"]{
  background: transparent;
  color: rgba(255,255,255,0.30);
  font-weight:700;
  border: none;
  padding-left:12px;
  box-shadow: none;
}

/* Electric band & visuals kept minimal for brevity */
.electric-band { position: fixed; top: calc(var(--topbar-h) + var(--header-h) - 6px); left:0; right:0; height:14px; z-index:1900; pointer-events:none }
.lightning-svg{ width:100vw; height:100%; display:block; pointer-events:none; mix-blend-mode:screen }
.orb{ width:8px; height:8px; border-radius:50%; background: radial-gradient(circle at 30% 30%, #fff8b0, var(--electric-yellow)); box-shadow:0 0 12px rgba(255,214,0,0.95)}

/* Hero, sections, cards and footer kept same as before (shortened here for clarity) */
.hero{margin-top:calc(var(--topbar-h) + var(--header-h));height:35vh;min-height:240px;background:url("chantier_solaire.png") center/cover no-repeat;display:flex;align-items:center;justify-content:center;position:relative;text-align:center}
.hero::after{content:"";position:absolute;inset:0;background:rgba(0,0,0,.45)}
.hero-content{position:relative;z-index:1;max-width:900px;padding:0 20px;display:flex;flex-direction:column;align-items:center;gap:12px}
.hero-content h1{font-size:36px;margin:0;color:#fff}
.hero-content p{font-size:18px;margin:0;color:#fff}
.btn-primary{padding:12px 28px;border-radius:8px;border:0;background:var(--accent);color:#072012;font-weight:700;cursor:pointer}

/* Sections / cards / form / footer (kept full as in your file) */
.section{padding:40px 5vw;text-align:center}
.section h2{font-size:28px;margin-bottom:16px;color:var(--accent-2);display:flex;gap:10px;align-items:center;justify-content:center}
.section p.description{max-width:900px;margin:0 auto 20px;color:#e6f7ea;line-height:1.6}
.cards{display:flex;gap:20px;flex-wrap:wrap;justify-content:center;align-items:stretch}
.card{background:#fff;color:#0a4d2e;border-radius:14px;overflow:hidden;width:280px;box-shadow:0 10px 22px rgba(0,0,0,0.35);transition:transform .28s,box-shadow .28s}
.card:hover{transform:translateY(-8px);box-shadow:0 18px 44px rgba(0,0,0,0.55)}
.card img{width:100%;height:200px;object-fit:contain;background:#f8f8f8}
.card-content{padding:18px 20px;text-align:center}
.card-content h3{font-size:18px;margin:6px 0;font-weight:700}
.card-content p{font-size:14px;color:#0a4d2e;margin:8px 0}
.btn{padding:10px 18px;border-radius:8px;border:0;background:#0a4d2e;color:#fff;cursor:pointer}
#devis form{max-width:520px;margin:18px auto 0;display:flex;flex-direction:column;gap:12px;background:rgba(0,0,0,0.55);padding:20px;border-radius:12px}
#devis input,#devis textarea,#devis select{width:100%;padding:12px;border-radius:8px;border:1px solid rgba(124,179,66,0.18);background:transparent;color:#fff;font-size:14px}
footer{background:var(--green-dark);color:#fff;padding:28px 5vw 36px;position:relative;margin-top:40px;text-align:center}
.footer-company{display:block;margin:0 auto 8px;font-size:18px;font-weight:800;color:#04462e;-webkit-text-stroke:0.7px var(--gold-base);text-shadow:0 3px 6px rgba(0,0,0,0.6);padding:4px 8px;border-radius:6px;width:max-content;background: linear-gradient(90deg, rgba(212,175,55,0.02), rgba(255,255,255,0) 40%)}

/* Responsive */
@media (max-width:1100px){
  .cards{flex-direction:row;flex-wrap:wrap;justify-content:center}
  .burger{display:flex !important}
  nav{display:none}
}
@media (max-width:820px){
  .card{width:100%;max-width:640px}
  .hero{height:40vh}
  .company-name{font-size:24px}
}
</style>
</head>
<body>

<!-- Topbar -->
<div class="topbar" role="banner">
  <div class="left"><a href="#" aria-label="Localisation"><i class="fas fa-map-marker-alt" aria-hidden="true"></i> Abidjan, C√¥te d‚ÄôIvoire</a></div>
  <div class="right"><a href="tel:+22507070707"><i class="fas fa-phone" aria-hidden="true"></i> +225 07 07 07 07 07</a></div>
</div>

<!-- Header -->
<header role="navigation" aria-label="Main">
  <div class="logo-text">
    <a href="Code1.html"><img src="green bridge domo.png" alt="Logo GreenBridge"></a>
    <div class="company-name">GREENBRIDGE</div>
  </div>

  <!-- hamburger (mobile) -->
  <button class="burger" id="burgerBtn" aria-label="Ouvrir le menu mobile" aria-expanded="false" aria-controls="mobileNav">
    <span class="icon"><span></span><span></span><span></span></span>
  </button>

  <nav aria-label="Menu principal">
    <a href="Code1.html">Accueil</a>

    <div class="dropdown" aria-haspopup="true" aria-expanded="false">
      <a href="energie.html" data-current="‚ö° Panneaux solaires" id="energieLink" aria-controls="dropdownContent">
        √ânergie
        <span class="sub-badge">‚ö° Panneaux solaires</span>
        <span class="caret-desktop" id="caretDesktop" aria-hidden="true"><i class="fas fa-chevron-down" aria-hidden="true"></i></span>
      </a>

      <ul class="dropdown-content" role="menu" aria-label="Sous-menu √©nergie" id="dropdownContent">
        <li><a href="panneaux.html">‚ö° Panneaux solaires</a></li>
        <li><a href="batteries.html">üîã Batteries & stockage</a></li>
        <li><a href="onduleurs.html">üîå Onduleurs</a></li>
        <li><a href="groupes.html">‚öôÔ∏è Groupes √©lectrog√®nes</a></li>
      </ul>
    </div>

    <a href="domotique.html">Domotique</a>
    <a href="securite.html">S√©curit√©</a>
    <a href="maintenance.html">Maintenance</a>
  </nav>
</header>

<!-- mobile nav -->
<div class="mobile-nav" id="mobileNav" aria-hidden="true">
  <div class="inner">
    <a href="Code1.html" class="mobile-link">Accueil</a>

    <div>
      <a href="energie.html" id="mobileEnergieToggle" class="mobile-link active" data-current="‚ö° Panneaux solaires" aria-expanded="true">
        √ânergie
        <span class="caret" aria-hidden="true"><i class="fas fa-chevron-down" style="margin-left:6px"></i></span>
      </a>
      <div class="submenu" id="mobileEnergieSub" style="display:flex;flex-direction:column;">
        <a href="panneaux.html">‚ö° Panneaux solaires</a>
        <a href="batteries.html">üîã Batteries & stockage</a>
        <a href="onduleurs.html">üîå Onduleurs</a>
        <a href="groupes.html">‚öôÔ∏è Groupes √©lectrog√®nes</a>
      </div>
    </div>

    <a href="domotique.html" class="mobile-link">Domotique</a>
    <a href="securite.html" class="mobile-link">S√©curit√©</a>
    <a href="maintenance.html" class="mobile-link">Maintenance</a>

    <div style="margin-top:8px;border-top:1px solid rgba(255,255,255,0.03);padding-top:10px;display:flex;gap:12px;align-items:center;">
      <a href="#" aria-label="Facebook"><i class="fab fa-facebook" aria-hidden="true"></i></a>
      <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i></a>
      <a href="#" aria-label="Instagram"><i class="fab fa-instagram" aria-hidden="true"></i></a>
    </div>
  </div>
</div>

<!-- electric band -->
<div class="electric-band" id="energyBand" aria-hidden="true">
  <div class="container" aria-hidden="true">
    <svg class="lightning-svg" viewBox="0 0 2000 40" preserveAspectRatio="none" aria-hidden="true">
      <path class="zap" d="M10,22 C260,6 520,36 840,20 C1120,8 1440,34 1760,18 C1880,6 1960,28 1990,22" stroke-opacity="0.14"/>
      <path class="zap" d="M10,24 C280,36 600,6 860,22 C1140,36 1460,6 1800,22 C1880,36 1960,10 1990,22" stroke-opacity="0.10"/>
      <path class="bright" id="zapBright" d="M20,22 C300,6 600,34 880,16 C1240,0 1520,32 1860,14 C1960,2 1980,30 1990,22" stroke-opacity="1" stroke-dasharray="520" stroke-dashoffset="520"/>
    </svg>
    <div class="orbs" id="energyOrbs"><div class="orb" id="eOrbA"></div><div class="orb" id="eOrbB"></div><div class="orb" id="eOrbC"></div></div>
    <div class="glowline" id="eGlowline"></div>
  </div>
</div>

<!-- Hero -->
<section class="hero" id="top" aria-label="Hero">
  <div class="hero-content">
    <h1>Panneaux Solaires</h1>
    <p>Produisez votre √©nergie propre et durable avec nos solutions.</p>
    <button class="btn-primary" onclick="document.getElementById('devis').scrollIntoView({behavior:'smooth'})">Demander un devis</button>
  </div>
</section>

<!-- Sections: Monocristallins / Poly / Thin-Film (kept from your content) -->
<section class="section">
  <h2><i class="fas fa-solar-panel"></i> Monocristallins</h2>
  <p class="description">Les panneaux monocristallins offrent le rendement le plus √©lev√©, une efficacit√© optimale sur des surfaces r√©duites et une longue dur√©e de vie. Id√©als pour les installations r√©sidentielles et commerciales exigeantes.</p>
  <div class="cards" role="list">
    <div class="card" role="listitem"><img src="panneau_mono1.png" alt="Panneau 350W Monocristallin"><div class="card-content"><h3>Panneau 350W</h3><p>Haute performance pour usage r√©sidentiel.</p><button class="btn" onclick="openModal('panneau_mono1.png','Panneau 350W','Rendement optimal, garantie 20 ans.')">D√©tails</button></div></div>
    <div class="card" role="listitem"><img src="panneau_mono2.png" alt="Panneau 500W Monocristallin"><div class="card-content"><h3>Panneau 500W</h3><p>Excellente efficacit√© pour installations professionnelles.</p><button class="btn" onclick="openModal('panneau_mono2.png','Panneau 500W','Haute puissance, parfait pour usages industriels.')">D√©tails</button></div></div>
    <div class="card" role="listitem"><img src="panneau_mono3.png" alt="Panneau hybride Monocristallin"><div class="card-content"><h3>Panneau hybride</h3><p>Combine production d‚Äô√©lectricit√© et chauffe-eau solaire.</p><button class="btn" onclick="openModal('panneau_mono3.png','Panneau hybride','Solution innovante et polyvalente.')">D√©tails</button></div></div>
  </div>
</section>

<section class="section">
  <h2><i class="fas fa-solar-panel"></i> Polycristallins</h2>
  <p class="description">Les panneaux polycristallins offrent un bon rapport qualit√©/prix.</p>
  <div class="cards" role="list">
    <div class="card" role="listitem"><img src="panneau_poly1.png" alt="Panneau 250W Polycristallin"><div class="card-content"><h3>Panneau 250W</h3><p>Solution √©conomique pour petites installations.</p><button class="btn" onclick="openModal('panneau_poly1.png','Panneau 250W','Fiable et √©conomique.')">D√©tails</button></div></div>
    <div class="card" role="listitem"><img src="panneau_poly2.png" alt="Panneau 300W Polycristallin"><div class="card-content"><h3>Panneau 300W</h3><p>Polyvalent et performant pour installations domestiques.</p><button class="btn" onclick="openModal('panneau_poly2.png','Panneau 300W','Rapport qualit√©/prix √©quilibr√©.')">D√©tails</button></div></div>
    <div class="card" role="listitem"><img src="panneau_poly3.png" alt="Panneau 350W Polycristallin"><div class="card-content"><h3>Panneau 350W</h3><p>Performances stables et fiables pour usage g√©n√©ral.</p><button class="btn" onclick="openModal('panneau_poly3.png','Panneau 350W','Fiable pour installations √©conomiques et commerciales.')">D√©tails</button></div></div>
  </div>
</section>

<section class="section">
  <h2><i class="fas fa-solar-panel"></i> Film mince (Thin-Film)</h2>
  <p class="description">Les panneaux √† film mince sont l√©gers et flexibles, adapt√©s aux surfaces non conventionnelles.</p>
  <div class="cards" role="list">
    <div class="card" role="listitem"><img src="panneau_thin1.png" alt="Panneau Amorphe Thin-Film"><div class="card-content"><h3>Amorphe</h3><p>Flexibilit√© et l√©g√®ret√© pour toitures complexes.</p><button class="btn" onclick="openModal('panneau_thin1.png','Amorphe','Adapt√© aux toitures courbes.')">D√©tails</button></div></div>
    <div class="card" role="listitem"><img src="panneau_thin2.png" alt="Panneau CdTe Thin-Film"><div class="card-content"><h3>CdTe</h3><p>Bon rendement en faible luminosit√©.</p><button class="btn" onclick="openModal('panneau_thin2.png','CdTe','Performance stable par temps nuageux.')">D√©tails</button></div></div>
    <div class="card" role="listitem"><img src="panneau_thin3.png" alt="Panneau CIGS Thin-Film"><div class="card-content"><h3>CIGS</h3><p>Haute stabilit√© et durabilit√©.</p><button class="btn" onclick="openModal('panneau_thin3.png','CIGS','Id√©al pour installations professionnelles.')">D√©tails</button></div></div>
  </div>
</section>

<!-- modal -->
<div id="productModal" style="display:none;position:fixed;z-index:2000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6)">
  <div style="background:#fff;color:#072012;margin:6% auto;padding:18px;border-radius:12px;max-width:520px;position:relative;text-align:center">
    <button onclick="closeModal()" style="position:absolute;right:12px;top:8px;background:transparent;border:0;font-size:22px;cursor:pointer;color:#072012">&times;</button>
    <img id="modalImg" src="" alt="" style="width:100%;height:220px;object-fit:contain;margin-bottom:12px">
    <h3 id="modalTitle" style="margin:0 0 8px"></h3>
    <p id="modalDesc" style="color:#333;margin:0 0 8px"></p>
  </div>
</div>

<!-- devis -->
<section id="devis" class="section">
  <h2>Demandez votre devis personnalis√©</h2>
  <form>
    <input type="text" placeholder="Nom" required>
    <input type="email" placeholder="Email" required>
    <select required>
      <option value="">Type de projet</option>
      <option value="energie">√ânergie</option>
      <option value="domotique">Domotique</option>
      <option value="securite">S√©curit√©</option>
    </select>
    <textarea placeholder="Message ou d√©tails du projet" rows="5" required></textarea>
    <button type="submit">Envoyer le devis</button>
  </form>
</section>

<!-- footer -->
<footer>
  <div class="footer-company" aria-hidden="false">GREENBRIDGE</div>
  <div class="footer-contact" aria-label="Coordonn√©es">
    <div>¬© 2025 GreenBridge √ânergie. Tous droits r√©serv√©s.</div>
    <div>Abidjan, C√¥te d‚ÄôIvoire</div>
    <div>Tel: +225 07 07 07 07 07</div>
  </div>
</footer>

<script>
/* Modal helpers */
function openModal(img, title, desc){
  document.getElementById("modalImg").src = img || "";
  document.getElementById("modalTitle").innerText = title || "";
  document.getElementById("modalDesc").innerText = desc || "";
  const pm = document.getElementById('productModal');
  if(pm) pm.style.display = 'block';
}
function closeModal(){ const el = document.getElementById('productModal'); if(el) el.style.display = 'none'; }

/* Dropdown hover + caret */
document.querySelectorAll('.dropdown').forEach(drop => {
  let timer;
  const menu = drop.querySelector('.dropdown-content');
  const trigger = drop.querySelector('a');
  const caret = drop.querySelector('.caret-desktop');

  function open(){ if(menu) menu.style.display = 'block'; drop.setAttribute('aria-expanded','true'); }
  function close(){ if(menu) menu.style.display = 'none'; drop.setAttribute('aria-expanded','false'); }

  drop.addEventListener('mouseenter', () => { clearTimeout(timer); open(); });
  drop.addEventListener('mouseleave', () => { timer = setTimeout(()=> close(), 220); });

  if(caret){
    caret.addEventListener('click', (e)=>{ e.preventDefault(); e.stopPropagation(); if(menu && menu.style.display === 'block'){ close(); } else { open(); } });
    caret.addEventListener('touchend', (e)=>{ e.preventDefault(); e.stopPropagation(); if(menu && menu.style.display === 'block'){ close(); } else { open(); } }, {passive:false});
  }

  trigger.addEventListener('click', function(e){
    if(window.innerWidth <= 1100){
      e.preventDefault();
      if(menu && menu.style.display === 'block'){ close(); } else { open(); }
      const mobileNav = document.getElementById('mobileNav');
      const burger = document.getElementById('burgerBtn');
      if(mobileNav && burger){ mobileNav.classList.add('open'); burger.classList.add('open'); mobileNav.setAttribute('aria-hidden','false'); burger.setAttribute('aria-expanded','true'); document.body.style.overflow='hidden'; }
    }
  });
});

/* Mobile burger behavior */
(function(){
  const burger = document.getElementById('burgerBtn');
  const mobileNav = document.getElementById('mobileNav');
  if(!burger || !mobileNav) return;

  burger.addEventListener('click', ()=> {
    const opened = mobileNav.classList.toggle('open');
    burger.classList.toggle('open', opened);
    burger.setAttribute('aria-expanded', String(opened));
    mobileNav.setAttribute('aria-hidden', String(!opened));
    document.body.style.overflow = opened ? 'hidden' : '';
    const sub = document.getElementById('mobileEnergieSub');
    const toggle = document.getElementById('mobileEnergieToggle');
    if(opened && toggle && toggle.classList.contains('active')) {
      sub.style.display = 'flex';
      toggle.setAttribute('aria-expanded','true');
    }
  });

  mobileNav.addEventListener('click', function(e){
    const a = e.target.closest('a');
    if(!a) return;
    if (a.querySelector('.caret')) return;
    mobileNav.classList.remove('open');
    burger.classList.remove('open');
    mobileNav.setAttribute('aria-hidden','true');
    burger.setAttribute('aria-expanded','false');
    document.body.style.overflow = '';
  });

  const energieToggle = document.getElementById('mobileEnergieToggle');
  const energieSub = document.getElementById('mobileEnergieSub');
  if(energieToggle && energieSub){
    energieToggle.addEventListener('click', function(e){
      if(e.target.closest('.caret')){
        e.preventDefault(); e.stopPropagation();
        const opening = energieSub.style.display !== 'flex';
        document.querySelectorAll('.mobile-nav .submenu').forEach(s=>{ if(s!==energieSub) s.style.display='none'; });
        energieSub.style.display = opening ? 'flex' : 'none';
        energieToggle.setAttribute('aria-expanded', String(opening));
        energieToggle.classList.toggle('active', opening);
        mobileNav.classList.add('open'); document.getElementById('burgerBtn').classList.add('open');
        mobileNav.setAttribute('aria-hidden','false'); document.getElementById('burgerBtn').setAttribute('aria-expanded','true');
      } else {
        mobileNav.classList.remove('open');
        burger.classList.remove('open');
        mobileNav.setAttribute('aria-hidden','true');
        burger.setAttribute('aria-expanded','false');
        document.body.style.overflow = '';
      }
    });
  }

  document.addEventListener('keydown', function(e){
    if(e.key === 'Escape' && mobileNav.classList.contains('open')){
      mobileNav.classList.remove('open'); burger.classList.remove('open');
      mobileNav.setAttribute('aria-hidden','true'); burger.setAttribute('aria-expanded','false'); document.body.style.overflow = '';
    }
  });

  function openActiveSubmenuOnSmall(){
    if(window.innerWidth <= 1100){
      const activeToggle = document.getElementById('mobileEnergieToggle');
      const activeSub = document.getElementById('mobileEnergieSub');
      if(activeToggle && activeSub){ activeSub.style.display = 'flex'; activeToggle.setAttribute('aria-expanded','true'); activeToggle.classList.add('active'); }
    } else {
      const activeSub = document.getElementById('mobileEnergieSub');
      if(activeSub) activeSub.style.display = 'none';
    }
  }
  window.addEventListener('resize', openActiveSubmenuOnSmall);
  openActiveSubmenuOnSmall();
})();

/* Auto-detect active link and enforce consistent visuals & mobile non-clickable active item */
(function(){
  // get current filename (fallback to panneaux.html)
  const raw = window.location.pathname.split('/').pop().toLowerCase();
  const path = raw || 'panneaux.html';
  const mapping = {
    'code1.html':'a[href="Code1.html"]',
    'energie.html':'a[href="energie.html"]',
    'panneaux.html':'a[href="panneaux.html"]',
    'batteries.html':'a[href="batteries.html"]',
    'onduleurs.html':'a[href="onduleurs.html"]',
    'groupes.html':'a[href="groupes.html"]',
    'domotique.html':'a[href="domotique.html"]',
    'securite.html':'a[href="securite.html"]',
    'maintenance.html':'a[href="maintenance.html"]'
  };

  const sel = mapping[path];
  if(!sel) return;
  const el = document.querySelector(sel);
  if(!el) return;

  // if element is inside the dropdown menu (child page)
  const inDropdown = !!el.closest('.dropdown-content');

  if(!inDropdown){
    // top-level page active -> mark top-level link as active
    el.classList.add('active');
  } else {
    // child active -> mark child active, keep parent neutral
    el.classList.add('active-item');
    el.setAttribute('aria-current','page');

    // update desktop badge to show the active child text but make badge transparent (no rectangle)
    const dropdown = document.querySelector('.dropdown');
    if(dropdown){
      const energieLink = dropdown.querySelector('a[data-current], a[href="energie.html"]');
      const subBadge = energieLink ? energieLink.querySelector('.sub-badge') : null;
      if(subBadge){
        const label = el.textContent ? el.textContent.trim() : subBadge.textContent.trim();
        subBadge.textContent = label;
        // make badge visually transparent for the active child (as you requested)
        subBadge.style.background = 'transparent';
        subBadge.style.boxShadow = 'none';
        subBadge.style.color = 'var(--electric-yellow)';
      }
    }

    // MOBILE: find corresponding mobile submenu link and replace it with a non-clickable span
    try{
      const mobileSub = document.querySelector('.mobile-nav .submenu');
      if(mobileSub){
        const href = el.getAttribute('href');
        const mobileA = mobileSub.querySelector('a[href="'+href+'"]');
        if(mobileA){
          // create a span with same content and active-item class, replace the anchor (non-clickable)
          const span = document.createElement('span');
          span.className = 'active-item';
          span.setAttribute('aria-current','page');
          span.textContent = mobileA.textContent.trim();
          // copy small attributes if needed
          mobileA.parentNode.replaceChild(span, mobileA);
        }
        // ensure mobile toggle shows the badge text and opens submenu
        const toggle = document.getElementById('mobileEnergieToggle');
        if(toggle){
          toggle.classList.add('active');
          toggle.setAttribute('aria-expanded','true');
          // keep the data-current attribute (used in CSS to display badge)
        }
      }
    }catch(e){}
  }
})();
</script>
</body>
</html>
